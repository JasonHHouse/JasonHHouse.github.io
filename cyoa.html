<!DOCTYPE html>
<html>

<head>
  <title>Choose Your Adventure</title>
</head>

<body>
  <div id="story"></div>
  <div id="options"></div>

  <script>

    let currentNode;
    let story;

    async function playStory() {
      const response = await fetch('teststory.json');
      story = await response.json();

      currentNode = story.start_node;

      displayStory();
      displayOptions();
    }

    playStory();

    function displayStory() {
      const current = story.nodes[currentNode];
      document.getElementById("story").innerHTML = current.message.map(msg => `<p>${msg.sender}: ${msg.body}</p>`).join("");
    }

    function displayOptions() {
      const current = story.nodes[currentNode];
      document.getElementById("options").innerHTML = current.options.map(option => `<button onclick="navigate('${option.destination}')">${option.text}</button>`).join("");
    }

    function navigate(destination) {
      currentNode = destination;
      displayStory();
      displayOptions();
    }
  </script>
</body>

</html>